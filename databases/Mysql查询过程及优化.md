# Mysql查询过程及优化



## ![image-20190617112317539](/Users/hu/Library/Application Support/typora-user-images/image-20190617112317539.png)



我们根据上图来讲解



## 1.客户端/服务器通信协议

​			在客户端与服务器通信中是半双工的,也就是说在同一时刻要么是客户端在给服务器发送消息,要么就是服务器在给客户端发送消息,在客户端给服务器发送消息时必须一次性发送完毕,无法分割成小块进行发送.

​			客户端用一个单独的数据包将查询请求发给服务器,如果数据过程需要加max_allowed_packet参数,但是如果查询太大服务器将会拒绝报错



​           **相反的是服务器分会的数据将分多个数据包返回,服务器的返回客户端必须完成接收整个结果,而不能只取前几条,索引在查询是保持返回的数据都是必要的数据,减少通信包大小和数量**



## 2.查询缓存



如果查询缓存是打开的,请求都先将去缓存中去找数据,如果缓存中有数据直接返回不需要进行后面的步骤



mysql将缓存放在一个引用表中,通过hash值索引,这个hash值就是索引本身,



