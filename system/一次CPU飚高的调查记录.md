# 一次CPU飚高的调查记录



后台管理系统特别卡顿, 无法使用, 在服务器使用TOP名称查看CPU问题

```shell
[root@iz2zeen6mal4s96ds66jfsz ~]# top
top - 11:21:23 up 56 days, 12:20,  5 users,  load average: 0.91, 0.59, 0.58
Tasks:  91 total,   1 running,  90 sleeping,   0 stopped,   0 zombie
%Cpu(s):  99 us,  1.0 sy,  0.0 ni, 96.5 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :  8008976 total,  2210232 free,  1582368 used,  4216376 buff/cache
KiB Swap:        0 total,        0 free,        0 used.  6120052 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                            
23513 root      20   0 4797864   1.3g  19344 S   103.0 16.6  12:46.80 java                                                                                                               
23762 root      10 -10  176680  49856   6464 S   2.7  0.6   1172:46 AliYunDun          
```



我们看到了一个PID 为 23513 的线程CPU已经,特别高了, 首先定位一个是不是内存太低,导致频繁GC问题



```shell
[root@iz2zeen6mal4s96ds66jfsz ~]# jstat -gc 23513 1000
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC  YGCT      FGC    FGCT     GCT   
33280.0 33280.0  0.0   9051.7 601088.0 37170.8   302080.0   195807.8  94912.0 86006.8 10176.0 8652.4    427   10.627   5      1.122   11.748
33280.0 33280.0  0.0   9051.7 601088.0 279424.0  302080.0   195807.8  94912.0 86006.8 10176.0 8652.4    427   10.627   5      1.122   11.748
33280.0 33280.0  0.0   9051.7 601088.0 428500.2  302080.0   195807.8  94912.0 86006.8 10176.0 8652.4    427   10.627   5      1.122   11.748
33280.0 33280.0  0.0   9051.7 601088.0 574081.9  302080.0   195807.8  94912.0 86006.8 10176.0 8652.4    427   10.627   5      1.122   11.748
32256.0 32768.0 20578.7  0.0   601088.0 115478.5  302080.0   195935.8  94912.0 86006.8 10176.0 8652.4    428   10.669   5      1.122   11.791
32256.0 32768.0 20578.7  0.0   601088.0 258601.6  302080.0   195935.8  94912.0 86006.8 10176.0 8652.4    428   10.669   5      1.122   11.791
32256.0 32768.0 20578.7  0.0   601088.0 406396.7  302080.0   195935.8  94912.0 86006.8 10176.0 8652.4    428   10.669   5      1.122   11.791
```



`S0C、S1C、S0U、S1U：Survivor 0/1区容量（Capacity）和使用量（Used）`

`EC、EU：Eden区容量和使用量`

`OC、OU：年老代容量和使用量`

`PC、PU：永久代容量和使用量`

`YGC、YGT：年轻代GC次数和GC耗时`

`FGC、FGCT：Full GC次数和Full GC耗时`

`GCT：GC总耗时`



发现出现了频繁GC的问题